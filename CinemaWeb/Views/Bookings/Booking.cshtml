@model BookingModel

@if (Context.Session.IsSignedIn())
{
    <div class="p-1 mb-2 bg-dark text-light">
        <ul class="nav nav-pills mb-3">
            <li class="nav-item">
                <a class="nav-link" asp-controller="User" asp-action="Logout">Sign out</a>
            </li>
        </ul>
    </div>
    <li class="nav-item">
        <a class="nav-link" href="#">Hello, @Context.Session.GetUsername()!</a>
    </li>


    @if (Model.Bookings.Count != 0)
    {
        @foreach (var booking in Model.Bookings)
        {
            <div class="card mb-3" style="max-width: 1200px;">
                <div class="row no-gutters">
                    <div class="col-md-4"><img src="@booking.Pic" class="img-fluid" alt="..."></div>
                    <div class="col-md-8 bg-dark">
                        <div class="card-body @(ViewContext.RouteData.Values["action"].ToString() == "Booking" ? "active" : "")">
                            <a class="text-warning" asp-controller="Bookings" asp-action="Booking" asp-route-id="@booking.Id">@booking.Title</a>
                            <p class="card-text, text-warning">@booking.Description</p>
                            <p class="card-text"><small class="text-muted">@booking.SelectedTime</small></p>
                            <p class="card-text, text-warning">Auditorium @booking.Auditorium .</p>
                        </div>
                    </div>


                    <div class="container bg-warning text-dark">
                        <div class="row">
                            <div class="col-md-8">
                                <p class="card-text">Booking information</p>
                                <p class="card-text">Tickets: ____________________</p>
                            </div>

                            <div class="col-md-4">
                                <br />
                                <div class="dropdown">
                                    <button class="btn btn-secondary btn-dark text-warning dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Select your seat</button>
                                    <div class="dropdown-menu bg-transparent text-warning" aria-labelledby="dropdownMenuButton">
                                        @foreach (var seatType in Model.SeatTypes)
                                        {
                                            <a class="dropdown-item @(seatType.SeatTypeId == Model.ChosenSeat?.SeatTypeId ? "active" : "")" asp-controller="Bookings" asp-action="SeatType" asp-route-id="@seatType.SeatTypeId">@seatType.Naming | @seatType.Price</a>
                                        }
                                    </div>
                                </div>
                                <br />
                                <br />
                                <br />
                                <br />
                                <blockquote class="blockquote text-right">
                                    <a class="btn btn-dark text-warning btn-sm" asp-controller="Bookings" asp-action="CancelBooking" asp-route-id="@booking.Id">Cancel booking</a>
                                </blockquote>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


        }
    }

    else
    {
        <div class="alert alert-warning" role="alert">You don't have any active bookings!</div>
    }
}







else
{
    <div class="p-1 mb-2 bg-dark text-light">
        <ul class="nav nav-pills mb-3">
            <li class="nav-item ">
                <a class="nav-link" asp-controller="User" asp-action="Login">Log In</a>
            </li>
            <li class="nav-item ">
                <a class="nav-link" asp-controller="User" asp-action="Register">Sign Up</a>
            </li>

        </ul>

    </div>




    @if (Model.Bookings.Count != 0)
    {
        @foreach (var booking in Model.Bookings)
        {
            <div class="card mb-3" style="max-width: 1200px;">
                <div class="row no-gutters">
                    <div class="col-md-4"><img src="@booking.Pic" class="img-fluid" alt="..."></div>
                    <div class="col-md-8 bg-dark">
                        <div class="card-body @(ViewContext.RouteData.Values["action"].ToString() == "Booking" ? "active" : "")">
                            <a class="text-warning" asp-controller="Bookings" asp-action="Booking" asp-route-id="@booking.Id">@booking.Title</a>
                            <p class="card-text, text-warning">@booking.Description</p>
                            <p class="card-text"><small class="text-muted">@booking.SelectedTime</small></p>
                            <a class="btn btn-warning" asp-controller="Bookings" asp-action="CancelBooking" asp-route-id="@booking.Id">Cancel booking</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="alert alert-warning" role="alert">To continue with your booking, you must sign in first</div>
        }
    }

    else
    {
        <div class="alert alert-warning" role="alert">You don't have any active bookings!</div>
    }
}





